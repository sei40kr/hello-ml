#+TITLE: 回帰の実装

#+BEGIN_SRC jupyter-python :session py
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline

# 学習データを読み込む
train = np.loadtxt('click.csv', delimiter=',', skiprows=1)
train_x = train[:,0]
train_y = train[:,1]

# プロット
plt.plot(train_x, train_y, 'o')
plt.show()
#+END_SRC

#+RESULTS:
[[file:./.ob-jupyter/4c8fa4c9bfa805737a75252f36a51e2502741076.png]]

\[
f_\theta(x)=\theta_0+\theta_1x
\]
\[E(\theta)=\frac{1}{2}\sum_{i=1}^{n}(y^{(i)}-f_\theta(x^{(i)}))^2\]

#+begin_src jupyter-python :session py
# パラメーターを初期化
theta0 = np.random.rand()
theta1 = np.random.rand()

# 予測関数
def f(x):
    return theta0 + theta1 * x

# 目的関数
def E(x, y):
    return 0.5 * np.sum(y - f(x)) ** 2
#+end_src

#+RESULTS:

\[
z^{(i)}=\frac{x^{(i)}-\mu}{\sigma}
\]

#+begin_src jupyter-python :session py
# 標準化
mu = train_x.mean()
sigma = train_x.std()
def standardize(x):
    return (x - mu) / sigma

train_z = standardize(train_x)

plt.plot(train_z, train_y, 'o')
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/5d79d8d5b90214af3d2962a8924fe7cc46120412.png]]

\[
\theta_0:=\theta_0-\eta\sum_{i=1}^n(f_\theta(x^{(i)})-y^{(i)})
\]
\[
\theta_1:=\theta_1-\eta\sum_{i=1}^n(f_\theta(x^{(i)})-y^{(i)})x^{(i)}
\]

#+begin_src jupyter-python :session py
# 学習率
eta = 1e-3

# 誤差の差分
diff = 1

# 更新回数
count = 0

# 学習を繰り返す
error = E(train_z, train_y)
while diff > 1e-2:
    # パラメーターを更新
    theta0, theta1 = theta0 - eta * np.sum(f(train_z) - train_y), theta1 - eta * np.sum((f(train_z) - train_y) * train_z)
    # 前回の誤差との差分を計算
    current_error = E(train_z, train_y)
    diff = error - current_error
    error = current_error
    # ログの出力
    count += 1
    log = '{}回目: theta0 = {:.3f}, theta1 = {:.3f}, 差分 = {:.4f}'
    print(log.format(count, theta0, theta1, diff))
#+end_src

#+RESULTS:
#+begin_example
1回目: theta0 = 8.852, theta1 = 2.826, 差分 = 1456761.9102
2回目: theta0 = 17.258, theta1 = 4.640, 差分 = 1399074.1386
3回目: theta0 = 25.495, theta1 = 6.416, 差分 = 1343670.8027
4回目: theta0 = 33.568, theta1 = 8.158, 差分 = 1290461.4389
5回目: theta0 = 41.480, theta1 = 9.864, 差分 = 1239359.1659
6回目: theta0 = 49.234, theta1 = 11.536, 差分 = 1190280.5429
7回目: theta0 = 56.832, theta1 = 13.175, 差分 = 1143145.4334
8回目: theta0 = 64.278, theta1 = 14.781, 差分 = 1097876.8743
9回目: theta0 = 71.576, theta1 = 16.355, 差分 = 1054400.9500
10回目: theta0 = 78.727, theta1 = 17.898, 差分 = 1012646.6724
11回目: theta0 = 85.736, theta1 = 19.409, 差分 = 972545.8642
12回目: theta0 = 92.604, theta1 = 20.891, 差分 = 934033.0480
13回目: theta0 = 99.335, theta1 = 22.342, 差分 = 897045.3393
14回目: theta0 = 105.931, theta1 = 23.765, 差分 = 861522.3438
15回目: theta0 = 112.395, theta1 = 25.159, 差分 = 827406.0590
16回目: theta0 = 118.731, theta1 = 26.526, 差分 = 794640.7791
17回目: theta0 = 124.939, theta1 = 27.865, 差分 = 763173.0042
18回目: theta0 = 131.023, theta1 = 29.177, 差分 = 732951.3533
19回目: theta0 = 136.986, theta1 = 30.463, 差分 = 703926.4797
20回目: theta0 = 142.829, theta1 = 31.723, 差分 = 676050.9911
21回目: theta0 = 148.555, theta1 = 32.959, 差分 = 649279.3718
22回目: theta0 = 154.167, theta1 = 34.169, 差分 = 623567.9087
23回目: theta0 = 159.667, theta1 = 35.355, 差分 = 598874.6195
24回目: theta0 = 165.057, theta1 = 36.518, 差分 = 575159.1846
25回目: theta0 = 170.338, theta1 = 37.657, 差分 = 552382.8809
26回目: theta0 = 175.515, theta1 = 38.773, 差分 = 530508.5188
27回目: theta0 = 180.587, theta1 = 39.867, 差分 = 509500.3815
28回目: theta0 = 185.559, theta1 = 40.940, 差分 = 489324.1663
29回目: theta0 = 190.431, theta1 = 41.990, 差分 = 469946.9294
30回目: theta0 = 195.205, theta1 = 43.020, 差分 = 451337.0310
31回目: theta0 = 199.884, theta1 = 44.029, 差分 = 433464.0845
32回目: theta0 = 204.469, theta1 = 45.018, 差分 = 416298.9068
33回目: theta0 = 208.963, theta1 = 45.988, 差分 = 399813.4701
34回目: theta0 = 213.366, theta1 = 46.937, 差分 = 383980.8567
35回目: theta0 = 217.682, theta1 = 47.868, 差分 = 368775.2147
36回目: theta0 = 221.912, theta1 = 48.780, 差分 = 354171.7162
37回目: theta0 = 226.056, theta1 = 49.674, 差分 = 340146.5163
38回目: theta0 = 230.118, theta1 = 50.550, 差分 = 326676.7142
39回目: theta0 = 234.099, theta1 = 51.409, 差分 = 313740.3163
40回目: theta0 = 238.000, theta1 = 52.250, 差分 = 301316.1998
41回目: theta0 = 241.823, theta1 = 53.075, 差分 = 289384.0783
42回目: theta0 = 245.569, theta1 = 53.883, 差分 = 277924.4688
43回目: theta0 = 249.241, theta1 = 54.675, 差分 = 266918.6598
44回目: theta0 = 252.839, theta1 = 55.451, 差分 = 256348.6809
45回目: theta0 = 256.365, theta1 = 56.212, 差分 = 246197.2731
46回目: theta0 = 259.821, theta1 = 56.957, 差分 = 236447.8611
47回目: theta0 = 263.208, theta1 = 57.687, 差分 = 227084.5258
48回目: theta0 = 266.526, theta1 = 58.403, 差分 = 218091.9786
49回目: theta0 = 269.779, theta1 = 59.105, 差分 = 209455.5363
50回目: theta0 = 272.966, theta1 = 59.792, 差分 = 201161.0970
51回目: theta0 = 276.090, theta1 = 60.466, 差分 = 193195.1176
52回目: theta0 = 279.151, theta1 = 61.126, 差分 = 185544.5909
53回目: theta0 = 282.151, theta1 = 61.773, 差分 = 178197.0251
54回目: theta0 = 285.091, theta1 = 62.407, 差分 = 171140.4229
55回目: theta0 = 287.972, theta1 = 63.029, 差分 = 164363.2622
56回目: theta0 = 290.796, theta1 = 63.638, 差分 = 157854.4770
57回目: theta0 = 293.563, theta1 = 64.235, 差分 = 151603.4397
58回目: theta0 = 296.275, theta1 = 64.820, 差分 = 145599.9435
59回目: theta0 = 298.932, theta1 = 65.393, 差分 = 139834.1857
60回目: theta0 = 301.537, theta1 = 65.954, 差分 = 134296.7520
61回目: theta0 = 304.089, theta1 = 66.505, 差分 = 128978.6006
62回目: theta0 = 306.590, theta1 = 67.044, 差分 = 123871.0480
63回目: theta0 = 309.041, theta1 = 67.573, 差分 = 118965.7545
64回目: theta0 = 311.443, theta1 = 68.091, 差分 = 114254.7106
65回目: theta0 = 313.798, theta1 = 68.599, 差分 = 109730.2241
66回目: theta0 = 316.105, theta1 = 69.097, 差分 = 105384.9072
67回目: theta0 = 318.366, theta1 = 69.584, 差分 = 101211.6649
68回目: theta0 = 320.581, theta1 = 70.062, 差分 = 97203.6830
69回目: theta0 = 322.753, theta1 = 70.530, 差分 = 93354.4171
70回目: theta0 = 324.881, theta1 = 70.989, 差分 = 89657.5822
71回目: theta0 = 326.966, theta1 = 71.439, 差分 = 86107.1419
72回目: theta0 = 329.010, theta1 = 71.880, 差分 = 82697.2991
73回目: theta0 = 331.012, theta1 = 72.312, 差分 = 79422.4861
74回目: theta0 = 332.975, theta1 = 72.735, 差分 = 76277.3556
75回目: theta0 = 334.899, theta1 = 73.150, 差分 = 73256.7723
76回目: theta0 = 336.784, theta1 = 73.557, 差分 = 70355.8042
77回目: theta0 = 338.631, theta1 = 73.955, 差分 = 67569.7143
78回目: theta0 = 340.441, theta1 = 74.346, 差分 = 64893.9536
79回目: theta0 = 342.216, theta1 = 74.728, 差分 = 62324.1531
80回目: theta0 = 343.954, theta1 = 75.103, 差分 = 59856.1166
81回目: theta0 = 345.658, theta1 = 75.471, 差分 = 57485.8144
82回目: theta0 = 347.328, theta1 = 75.831, 差分 = 55209.3761
83回目: theta0 = 348.964, theta1 = 76.184, 差分 = 53023.0848
84回目: theta0 = 350.568, theta1 = 76.530, 差分 = 50923.3707
85回目: theta0 = 352.140, theta1 = 76.869, 差分 = 48906.8052
86回目: theta0 = 353.680, theta1 = 77.201, 差分 = 46970.0957
87回目: theta0 = 355.189, theta1 = 77.527, 差分 = 45110.0799
88回目: theta0 = 356.669, theta1 = 77.846, 差分 = 43323.7208
89回目: theta0 = 358.118, theta1 = 78.158, 差分 = 41608.1014
90回目: theta0 = 359.539, theta1 = 78.465, 差分 = 39960.4206
91回目: theta0 = 360.931, theta1 = 78.765, 差分 = 38377.9879
92回目: theta0 = 362.295, theta1 = 79.059, 差分 = 36858.2196
93回目: theta0 = 363.633, theta1 = 79.348, 差分 = 35398.6341
94回目: theta0 = 364.943, theta1 = 79.630, 差分 = 33996.8482
95回目: theta0 = 366.227, theta1 = 79.907, 差分 = 32650.5730
96回目: theta0 = 367.486, theta1 = 80.179, 差分 = 31357.6103
97回目: theta0 = 368.719, theta1 = 80.445, 差分 = 30115.8490
98回目: theta0 = 369.927, theta1 = 80.705, 差分 = 28923.2613
99回目: theta0 = 371.112, theta1 = 80.961, 差分 = 27777.9002
100回目: theta0 = 372.273, theta1 = 81.211, 差分 = 26677.8953
101回目: theta0 = 373.410, theta1 = 81.457, 差分 = 25621.4507
102回目: theta0 = 374.525, theta1 = 81.697, 差分 = 24606.8412
103回目: theta0 = 375.618, theta1 = 81.933, 差分 = 23632.4103
104回目: theta0 = 376.688, theta1 = 82.164, 差分 = 22696.5669
105回目: theta0 = 377.737, theta1 = 82.390, 差分 = 21797.7828
106回目: theta0 = 378.766, theta1 = 82.612, 差分 = 20934.5906
107回目: theta0 = 379.773, theta1 = 82.829, 差分 = 20105.5808
108回目: theta0 = 380.761, theta1 = 83.042, 差分 = 19309.3998
109回目: theta0 = 381.729, theta1 = 83.251, 差分 = 18544.7476
110回目: theta0 = 382.677, theta1 = 83.455, 差分 = 17810.3756
111回目: theta0 = 383.607, theta1 = 83.656, 差分 = 17105.0847
112回目: theta0 = 384.517, theta1 = 83.852, 差分 = 16427.7234
113回目: theta0 = 385.410, theta1 = 84.045, 差分 = 15777.1855
114回目: theta0 = 386.285, theta1 = 84.233, 差分 = 15152.4090
115回目: theta0 = 387.142, theta1 = 84.418, 差分 = 14552.3736
116回目: theta0 = 387.982, theta1 = 84.599, 差分 = 13976.0996
117回目: theta0 = 388.806, theta1 = 84.777, 差分 = 13422.6460
118回目: theta0 = 389.613, theta1 = 84.951, 差分 = 12891.1093
119回目: theta0 = 390.403, theta1 = 85.122, 差分 = 12380.6213
120回目: theta0 = 391.178, theta1 = 85.289, 差分 = 11890.3487
121回目: theta0 = 391.938, theta1 = 85.453, 差分 = 11419.4909
122回目: theta0 = 392.682, theta1 = 85.613, 差分 = 10967.2791
123回目: theta0 = 393.411, theta1 = 85.770, 差分 = 10532.9748
124回目: theta0 = 394.126, theta1 = 85.925, 差分 = 10115.8690
125回目: theta0 = 394.827, theta1 = 86.076, 差分 = 9715.2806
126回目: theta0 = 395.513, theta1 = 86.224, 差分 = 9330.5555
127回目: theta0 = 396.186, theta1 = 86.369, 差分 = 8961.0655
128回目: theta0 = 396.845, theta1 = 86.511, 差分 = 8606.2073
129回目: theta0 = 397.491, theta1 = 86.650, 差分 = 8265.4015
130回目: theta0 = 398.124, theta1 = 86.787, 差分 = 7938.0916
131回目: theta0 = 398.745, theta1 = 86.921, 差分 = 7623.7432
132回目: theta0 = 399.353, theta1 = 87.052, 差分 = 7321.8429
133回目: theta0 = 399.949, theta1 = 87.181, 差分 = 7031.8980
134回目: theta0 = 400.533, theta1 = 87.306, 差分 = 6753.4348
135回目: theta0 = 401.105, theta1 = 87.430, 差分 = 6485.9988
136回目: theta0 = 401.666, theta1 = 87.551, 差分 = 6229.1532
137回目: theta0 = 402.216, theta1 = 87.669, 差分 = 5982.4788
138回目: theta0 = 402.754, theta1 = 87.786, 差分 = 5745.5726
139回目: theta0 = 403.282, theta1 = 87.900, 差分 = 5518.0479
140回目: theta0 = 403.800, theta1 = 88.011, 差分 = 5299.5332
141回目: theta0 = 404.307, theta1 = 88.120, 差分 = 5089.6717
142回目: theta0 = 404.804, theta1 = 88.228, 差分 = 4888.1207
143回目: theta0 = 405.291, theta1 = 88.333, 差分 = 4694.5511
144回目: theta0 = 405.768, theta1 = 88.436, 差分 = 4508.6469
145回目: theta0 = 406.235, theta1 = 88.536, 差分 = 4330.1045
146回目: theta0 = 406.694, theta1 = 88.635, 差分 = 4158.6324
147回目: theta0 = 407.143, theta1 = 88.732, 差分 = 3993.9505
148回目: theta0 = 407.583, theta1 = 88.827, 差分 = 3835.7901
149回目: theta0 = 408.014, theta1 = 88.920, 差分 = 3683.8928
150回目: theta0 = 408.437, theta1 = 89.011, 差分 = 3538.0106
151回目: theta0 = 408.851, theta1 = 89.101, 差分 = 3397.9054
152回目: theta0 = 409.257, theta1 = 89.188, 差分 = 3263.3484
153回目: theta0 = 409.655, theta1 = 89.274, 差分 = 3134.1198
154回目: theta0 = 410.045, theta1 = 89.358, 差分 = 3010.0086
155回目: theta0 = 410.427, theta1 = 89.441, 差分 = 2890.8123
156回目: theta0 = 410.802, theta1 = 89.521, 差分 = 2776.3361
157回目: theta0 = 411.169, theta1 = 89.600, 差分 = 2666.3932
158回目: theta0 = 411.528, theta1 = 89.678, 差分 = 2560.8040
159回目: theta0 = 411.881, theta1 = 89.754, 差分 = 2459.3962
160回目: theta0 = 412.226, theta1 = 89.828, 差分 = 2362.0041
161回目: theta0 = 412.564, theta1 = 89.902, 差分 = 2268.4687
162回目: theta0 = 412.896, theta1 = 89.973, 差分 = 2178.6374
163回目: theta0 = 413.221, theta1 = 90.043, 差分 = 2092.3633
164回目: theta0 = 413.540, theta1 = 90.112, 差分 = 2009.5058
165回目: theta0 = 413.852, theta1 = 90.179, 差分 = 1929.9293
166回目: theta0 = 414.158, theta1 = 90.245, 差分 = 1853.5041
167回目: theta0 = 414.458, theta1 = 90.310, 差分 = 1780.1054
168回目: theta0 = 414.752, theta1 = 90.373, 差分 = 1709.6132
169回目: theta0 = 415.040, theta1 = 90.435, 差分 = 1641.9125
170回目: theta0 = 415.322, theta1 = 90.496, 差分 = 1576.8928
171回目: theta0 = 415.598, theta1 = 90.556, 差分 = 1514.4478
172回目: theta0 = 415.869, theta1 = 90.614, 差分 = 1454.4757
173回目: theta0 = 416.135, theta1 = 90.672, 差分 = 1396.8784
174回目: theta0 = 416.395, theta1 = 90.728, 差分 = 1341.5621
175回目: theta0 = 416.650, theta1 = 90.783, 差分 = 1288.4362
176回目: theta0 = 416.900, theta1 = 90.837, 差分 = 1237.4141
177回目: theta0 = 417.145, theta1 = 90.890, 差分 = 1188.4125
178回目: theta0 = 417.386, theta1 = 90.941, 差分 = 1141.3514
179回目: theta0 = 417.621, theta1 = 90.992, 差分 = 1096.1539
180回目: theta0 = 417.851, theta1 = 91.042, 差分 = 1052.7462
181回目: theta0 = 418.077, theta1 = 91.091, 差分 = 1011.0574
182回目: theta0 = 418.299, theta1 = 91.138, 差分 = 971.0196
183回目: theta0 = 418.516, theta1 = 91.185, 差分 = 932.5672
184回目: theta0 = 418.729, theta1 = 91.231, 差分 = 895.6375
185回目: theta0 = 418.937, theta1 = 91.276, 差分 = 860.1703
186回目: theta0 = 419.141, theta1 = 91.320, 差分 = 826.1075
187回目: theta0 = 419.341, theta1 = 91.363, 差分 = 793.3937
188回目: theta0 = 419.538, theta1 = 91.406, 差分 = 761.9753
189回目: theta0 = 419.730, theta1 = 91.447, 差分 = 731.8011
190回目: theta0 = 419.918, theta1 = 91.488, 差分 = 702.8217
191回目: theta0 = 420.103, theta1 = 91.527, 差分 = 674.9900
192回目: theta0 = 420.284, theta1 = 91.566, 差分 = 648.2604
193回目: theta0 = 420.461, theta1 = 91.605, 差分 = 622.5893
194回目: theta0 = 420.635, theta1 = 91.642, 差分 = 597.9348
195回目: theta0 = 420.805, theta1 = 91.679, 差分 = 574.2565
196回目: theta0 = 420.972, theta1 = 91.715, 差分 = 551.5160
197回目: theta0 = 421.136, theta1 = 91.750, 差分 = 529.6759
198回目: theta0 = 421.296, theta1 = 91.785, 差分 = 508.7008
199回目: theta0 = 421.453, theta1 = 91.819, 差分 = 488.5562
200回目: theta0 = 421.607, theta1 = 91.852, 差分 = 469.2094
201回目: theta0 = 421.758, theta1 = 91.884, 差分 = 450.6287
202回目: theta0 = 421.906, theta1 = 91.916, 差分 = 432.7838
203回目: theta0 = 422.051, theta1 = 91.948, 差分 = 415.6456
204回目: theta0 = 422.193, theta1 = 91.978, 差分 = 399.1860
205回目: theta0 = 422.332, theta1 = 92.008, 差分 = 383.3782
206回目: theta0 = 422.468, theta1 = 92.038, 差分 = 368.1965
207回目: theta0 = 422.602, theta1 = 92.066, 差分 = 353.6159
208回目: theta0 = 422.733, theta1 = 92.095, 差分 = 339.6127
209回目: theta0 = 422.861, theta1 = 92.122, 差分 = 326.1640
210回目: theta0 = 422.987, theta1 = 92.149, 差分 = 313.2479
211回目: theta0 = 423.110, theta1 = 92.176, 差分 = 300.8433
212回目: theta0 = 423.231, theta1 = 92.202, 差分 = 288.9299
213回目: theta0 = 423.349, theta1 = 92.228, 差分 = 277.4883
214回目: theta0 = 423.465, theta1 = 92.253, 差分 = 266.4998
215回目: theta0 = 423.579, theta1 = 92.277, 差分 = 255.9464
216回目: theta0 = 423.690, theta1 = 92.301, 差分 = 245.8109
217回目: theta0 = 423.800, theta1 = 92.325, 差分 = 236.0768
218回目: theta0 = 423.907, theta1 = 92.348, 差分 = 226.7281
219回目: theta0 = 424.011, theta1 = 92.370, 差分 = 217.7497
220回目: theta0 = 424.114, theta1 = 92.393, 差分 = 209.1268
221回目: theta0 = 424.215, theta1 = 92.414, 差分 = 200.8454
222回目: theta0 = 424.314, theta1 = 92.436, 差分 = 192.8919
223回目: theta0 = 424.410, theta1 = 92.456, 差分 = 185.2534
224回目: theta0 = 424.505, theta1 = 92.477, 差分 = 177.9174
225回目: theta0 = 424.598, theta1 = 92.497, 差分 = 170.8718
226回目: theta0 = 424.689, theta1 = 92.517, 差分 = 164.1053
227回目: theta0 = 424.778, theta1 = 92.536, 差分 = 157.6067
228回目: theta0 = 424.866, theta1 = 92.555, 差分 = 151.3655
229回目: theta0 = 424.951, theta1 = 92.573, 差分 = 145.3714
230回目: theta0 = 425.035, theta1 = 92.591, 差分 = 139.6147
231回目: theta0 = 425.118, theta1 = 92.609, 差分 = 134.0860
232回目: theta0 = 425.198, theta1 = 92.626, 差分 = 128.7762
233回目: theta0 = 425.277, theta1 = 92.643, 差分 = 123.6766
234回目: theta0 = 425.355, theta1 = 92.660, 差分 = 118.7791
235回目: theta0 = 425.431, theta1 = 92.677, 差分 = 114.0754
236回目: theta0 = 425.505, theta1 = 92.693, 差分 = 109.5580
237回目: theta0 = 425.578, theta1 = 92.708, 差分 = 105.2195
238回目: theta0 = 425.649, theta1 = 92.724, 差分 = 101.0528
239回目: theta0 = 425.719, theta1 = 92.739, 差分 = 97.0511
240回目: theta0 = 425.788, theta1 = 92.754, 差分 = 93.2079
241回目: theta0 = 425.855, theta1 = 92.768, 差分 = 89.5169
242回目: theta0 = 425.921, theta1 = 92.782, 差分 = 85.9720
243回目: theta0 = 425.986, theta1 = 92.796, 差分 = 82.5675
244回目: theta0 = 426.049, theta1 = 92.810, 差分 = 79.2978
245回目: theta0 = 426.111, theta1 = 92.823, 差分 = 76.1576
246回目: theta0 = 426.172, theta1 = 92.836, 差分 = 73.1418
247回目: theta0 = 426.231, theta1 = 92.849, 差分 = 70.2454
248回目: theta0 = 426.290, theta1 = 92.862, 差分 = 67.4637
249回目: theta0 = 426.347, theta1 = 92.874, 差分 = 64.7921
250回目: theta0 = 426.403, theta1 = 92.886, 差分 = 62.2263
251回目: theta0 = 426.458, theta1 = 92.898, 差分 = 59.7622
252回目: theta0 = 426.512, theta1 = 92.910, 差分 = 57.3956
253回目: theta0 = 426.565, theta1 = 92.921, 差分 = 55.1227
254回目: theta0 = 426.616, theta1 = 92.932, 差分 = 52.9399
255回目: theta0 = 426.667, theta1 = 92.943, 差分 = 50.8435
256回目: theta0 = 426.717, theta1 = 92.954, 差分 = 48.8301
257回目: theta0 = 426.765, theta1 = 92.964, 差分 = 46.8964
258回目: theta0 = 426.813, theta1 = 92.975, 差分 = 45.0393
259回目: theta0 = 426.860, theta1 = 92.985, 差分 = 43.2557
260回目: theta0 = 426.906, theta1 = 92.995, 差分 = 41.5428
261回目: theta0 = 426.950, theta1 = 93.004, 差分 = 39.8977
262回目: theta0 = 426.994, theta1 = 93.014, 差分 = 38.3178
263回目: theta0 = 427.038, theta1 = 93.023, 差分 = 36.8004
264回目: theta0 = 427.080, theta1 = 93.032, 差分 = 35.3431
265回目: theta0 = 427.121, theta1 = 93.041, 差分 = 33.9435
266回目: theta0 = 427.162, theta1 = 93.050, 差分 = 32.5993
267回目: theta0 = 427.202, theta1 = 93.059, 差分 = 31.3084
268回目: theta0 = 427.240, theta1 = 93.067, 差分 = 30.0686
269回目: theta0 = 427.279, theta1 = 93.075, 差分 = 28.8779
270回目: theta0 = 427.316, theta1 = 93.083, 差分 = 27.7343
271回目: theta0 = 427.353, theta1 = 93.091, 差分 = 26.6360
272回目: theta0 = 427.389, theta1 = 93.099, 差分 = 25.5812
273回目: theta0 = 427.424, theta1 = 93.106, 差分 = 24.5682
274回目: theta0 = 427.458, theta1 = 93.114, 差分 = 23.5953
275回目: theta0 = 427.492, theta1 = 93.121, 差分 = 22.6609
276回目: theta0 = 427.525, theta1 = 93.128, 差分 = 21.7636
277回目: theta0 = 427.558, theta1 = 93.135, 差分 = 20.9017
278回目: theta0 = 427.590, theta1 = 93.142, 差分 = 20.0740
279回目: theta0 = 427.621, theta1 = 93.149, 差分 = 19.2791
280回目: theta0 = 427.652, theta1 = 93.156, 差分 = 18.5156
281回目: theta0 = 427.682, theta1 = 93.162, 差分 = 17.7824
282回目: theta0 = 427.711, theta1 = 93.168, 差分 = 17.0782
283回目: theta0 = 427.740, theta1 = 93.175, 差分 = 16.4019
284回目: theta0 = 427.768, theta1 = 93.181, 差分 = 15.7524
285回目: theta0 = 427.796, theta1 = 93.187, 差分 = 15.1286
286回目: theta0 = 427.823, theta1 = 93.192, 差分 = 14.5295
287回目: theta0 = 427.849, theta1 = 93.198, 差分 = 13.9542
288回目: theta0 = 427.875, theta1 = 93.204, 差分 = 13.4016
289回目: theta0 = 427.901, theta1 = 93.209, 差分 = 12.8709
290回目: theta0 = 427.926, theta1 = 93.215, 差分 = 12.3612
291回目: theta0 = 427.950, theta1 = 93.220, 差分 = 11.8717
292回目: theta0 = 427.974, theta1 = 93.225, 差分 = 11.4016
293回目: theta0 = 427.998, theta1 = 93.230, 差分 = 10.9501
294回目: theta0 = 428.021, theta1 = 93.235, 差分 = 10.5164
295回目: theta0 = 428.043, theta1 = 93.240, 差分 = 10.1000
296回目: theta0 = 428.065, theta1 = 93.245, 差分 = 9.7000
297回目: theta0 = 428.087, theta1 = 93.250, 差分 = 9.3159
298回目: theta0 = 428.108, theta1 = 93.254, 差分 = 8.9470
299回目: theta0 = 428.129, theta1 = 93.259, 差分 = 8.5927
300回目: theta0 = 428.150, theta1 = 93.263, 差分 = 8.2524
301回目: theta0 = 428.170, theta1 = 93.267, 差分 = 7.9256
302回目: theta0 = 428.189, theta1 = 93.272, 差分 = 7.6118
303回目: theta0 = 428.208, theta1 = 93.276, 差分 = 7.3104
304回目: theta0 = 428.227, theta1 = 93.280, 差分 = 7.0209
305回目: theta0 = 428.246, theta1 = 93.284, 差分 = 6.7428
306回目: theta0 = 428.264, theta1 = 93.288, 差分 = 6.4758
307回目: theta0 = 428.282, theta1 = 93.291, 差分 = 6.2194
308回目: theta0 = 428.299, theta1 = 93.295, 差分 = 5.9731
309回目: theta0 = 428.316, theta1 = 93.299, 差分 = 5.7366
310回目: theta0 = 428.333, theta1 = 93.302, 差分 = 5.5094
311回目: theta0 = 428.349, theta1 = 93.306, 差分 = 5.2912
312回目: theta0 = 428.365, theta1 = 93.309, 差分 = 5.0817
313回目: theta0 = 428.381, theta1 = 93.313, 差分 = 4.8804
314回目: theta0 = 428.396, theta1 = 93.316, 差分 = 4.6872
315回目: theta0 = 428.411, theta1 = 93.319, 差分 = 4.5016
316回目: theta0 = 428.426, theta1 = 93.323, 差分 = 4.3233
317回目: theta0 = 428.440, theta1 = 93.326, 差分 = 4.1521
318回目: theta0 = 428.455, theta1 = 93.329, 差分 = 3.9877
319回目: theta0 = 428.469, theta1 = 93.332, 差分 = 3.8298
320回目: theta0 = 428.482, theta1 = 93.335, 差分 = 3.6781
321回目: theta0 = 428.496, theta1 = 93.338, 差分 = 3.5325
322回目: theta0 = 428.509, theta1 = 93.340, 差分 = 3.3926
323回目: theta0 = 428.521, theta1 = 93.343, 差分 = 3.2582
324回目: theta0 = 428.534, theta1 = 93.346, 差分 = 3.1292
325回目: theta0 = 428.546, theta1 = 93.349, 差分 = 3.0053
326回目: theta0 = 428.558, theta1 = 93.351, 差分 = 2.8863
327回目: theta0 = 428.570, theta1 = 93.354, 差分 = 2.7720
328回目: theta0 = 428.582, theta1 = 93.356, 差分 = 2.6622
329回目: theta0 = 428.593, theta1 = 93.359, 差分 = 2.5568
330回目: theta0 = 428.604, theta1 = 93.361, 差分 = 2.4555
331回目: theta0 = 428.615, theta1 = 93.363, 差分 = 2.3583
332回目: theta0 = 428.626, theta1 = 93.366, 差分 = 2.2649
333回目: theta0 = 428.636, theta1 = 93.368, 差分 = 2.1752
334回目: theta0 = 428.647, theta1 = 93.370, 差分 = 2.0891
335回目: theta0 = 428.657, theta1 = 93.372, 差分 = 2.0064
336回目: theta0 = 428.667, theta1 = 93.375, 差分 = 1.9269
337回目: theta0 = 428.676, theta1 = 93.377, 差分 = 1.8506
338回目: theta0 = 428.686, theta1 = 93.379, 差分 = 1.7773
339回目: theta0 = 428.695, theta1 = 93.381, 差分 = 1.7069
340回目: theta0 = 428.704, theta1 = 93.383, 差分 = 1.6393
341回目: theta0 = 428.713, theta1 = 93.385, 差分 = 1.5744
342回目: theta0 = 428.722, theta1 = 93.386, 差分 = 1.5121
343回目: theta0 = 428.730, theta1 = 93.388, 差分 = 1.4522
344回目: theta0 = 428.739, theta1 = 93.390, 差分 = 1.3947
345回目: theta0 = 428.747, theta1 = 93.392, 差分 = 1.3395
346回目: theta0 = 428.755, theta1 = 93.394, 差分 = 1.2864
347回目: theta0 = 428.763, theta1 = 93.395, 差分 = 1.2355
348回目: theta0 = 428.771, theta1 = 93.397, 差分 = 1.1865
349回目: theta0 = 428.778, theta1 = 93.399, 差分 = 1.1396
350回目: theta0 = 428.786, theta1 = 93.400, 差分 = 1.0944
351回目: theta0 = 428.793, theta1 = 93.402, 差分 = 1.0511
352回目: theta0 = 428.800, theta1 = 93.403, 差分 = 1.0095
353回目: theta0 = 428.807, theta1 = 93.405, 差分 = 0.9695
354回目: theta0 = 428.814, theta1 = 93.406, 差分 = 0.9311
355回目: theta0 = 428.821, theta1 = 93.408, 差分 = 0.8942
356回目: theta0 = 428.827, theta1 = 93.409, 差分 = 0.8588
357回目: theta0 = 428.834, theta1 = 93.411, 差分 = 0.8248
358回目: theta0 = 428.840, theta1 = 93.412, 差分 = 0.7921
359回目: theta0 = 428.846, theta1 = 93.413, 差分 = 0.7608
360回目: theta0 = 428.852, theta1 = 93.415, 差分 = 0.7307
361回目: theta0 = 428.858, theta1 = 93.416, 差分 = 0.7017
362回目: theta0 = 428.864, theta1 = 93.417, 差分 = 0.6739
363回目: theta0 = 428.870, theta1 = 93.418, 差分 = 0.6472
364回目: theta0 = 428.875, theta1 = 93.420, 差分 = 0.6216
365回目: theta0 = 428.881, theta1 = 93.421, 差分 = 0.5970
366回目: theta0 = 428.886, theta1 = 93.422, 差分 = 0.5734
367回目: theta0 = 428.892, theta1 = 93.423, 差分 = 0.5507
368回目: theta0 = 428.897, theta1 = 93.424, 差分 = 0.5288
369回目: theta0 = 428.902, theta1 = 93.425, 差分 = 0.5079
370回目: theta0 = 428.907, theta1 = 93.426, 差分 = 0.4878
371回目: theta0 = 428.912, theta1 = 93.427, 差分 = 0.4685
372回目: theta0 = 428.916, theta1 = 93.428, 差分 = 0.4499
373回目: theta0 = 428.921, theta1 = 93.429, 差分 = 0.4321
374回目: theta0 = 428.926, theta1 = 93.430, 差分 = 0.4150
375回目: theta0 = 428.930, theta1 = 93.431, 差分 = 0.3986
376回目: theta0 = 428.935, theta1 = 93.432, 差分 = 0.3828
377回目: theta0 = 428.939, theta1 = 93.433, 差分 = 0.3676
378回目: theta0 = 428.943, theta1 = 93.434, 差分 = 0.3531
379回目: theta0 = 428.947, theta1 = 93.435, 差分 = 0.3391
380回目: theta0 = 428.951, theta1 = 93.436, 差分 = 0.3257
381回目: theta0 = 428.955, theta1 = 93.437, 差分 = 0.3128
382回目: theta0 = 428.959, theta1 = 93.438, 差分 = 0.3004
383回目: theta0 = 428.963, theta1 = 93.438, 差分 = 0.2885
384回目: theta0 = 428.967, theta1 = 93.439, 差分 = 0.2771
385回目: theta0 = 428.970, theta1 = 93.440, 差分 = 0.2661
386回目: theta0 = 428.974, theta1 = 93.441, 差分 = 0.2555
387回目: theta0 = 428.977, theta1 = 93.442, 差分 = 0.2454
388回目: theta0 = 428.981, theta1 = 93.442, 差分 = 0.2357
389回目: theta0 = 428.984, theta1 = 93.443, 差分 = 0.2264
390回目: theta0 = 428.988, theta1 = 93.444, 差分 = 0.2174
391回目: theta0 = 428.991, theta1 = 93.444, 差分 = 0.2088
392回目: theta0 = 428.994, theta1 = 93.445, 差分 = 0.2005
393回目: theta0 = 428.997, theta1 = 93.446, 差分 = 0.1926
394回目: theta0 = 429.000, theta1 = 93.446, 差分 = 0.1850
395回目: theta0 = 429.003, theta1 = 93.447, 差分 = 0.1776
396回目: theta0 = 429.006, theta1 = 93.448, 差分 = 0.1706
397回目: theta0 = 429.009, theta1 = 93.448, 差分 = 0.1638
398回目: theta0 = 429.012, theta1 = 93.449, 差分 = 0.1574
399回目: theta0 = 429.015, theta1 = 93.450, 差分 = 0.1511
400回目: theta0 = 429.017, theta1 = 93.450, 差分 = 0.1451
401回目: theta0 = 429.020, theta1 = 93.451, 差分 = 0.1394
402回目: theta0 = 429.023, theta1 = 93.451, 差分 = 0.1339
403回目: theta0 = 429.025, theta1 = 93.452, 差分 = 0.1286
404回目: theta0 = 429.028, theta1 = 93.452, 差分 = 0.1235
405回目: theta0 = 429.030, theta1 = 93.453, 差分 = 0.1186
406回目: theta0 = 429.032, theta1 = 93.453, 差分 = 0.1139
407回目: theta0 = 429.035, theta1 = 93.454, 差分 = 0.1094
408回目: theta0 = 429.037, theta1 = 93.454, 差分 = 0.1051
409回目: theta0 = 429.039, theta1 = 93.455, 差分 = 0.1009
410回目: theta0 = 429.042, theta1 = 93.455, 差分 = 0.0969
411回目: theta0 = 429.044, theta1 = 93.456, 差分 = 0.0931
412回目: theta0 = 429.046, theta1 = 93.456, 差分 = 0.0894
413回目: theta0 = 429.048, theta1 = 93.457, 差分 = 0.0858
414回目: theta0 = 429.050, theta1 = 93.457, 差分 = 0.0824
415回目: theta0 = 429.052, theta1 = 93.458, 差分 = 0.0792
416回目: theta0 = 429.054, theta1 = 93.458, 差分 = 0.0760
417回目: theta0 = 429.056, theta1 = 93.458, 差分 = 0.0730
418回目: theta0 = 429.058, theta1 = 93.459, 差分 = 0.0701
419回目: theta0 = 429.060, theta1 = 93.459, 差分 = 0.0674
420回目: theta0 = 429.061, theta1 = 93.460, 差分 = 0.0647
421回目: theta0 = 429.063, theta1 = 93.460, 差分 = 0.0621
422回目: theta0 = 429.065, theta1 = 93.460, 差分 = 0.0597
423回目: theta0 = 429.067, theta1 = 93.461, 差分 = 0.0573
424回目: theta0 = 429.068, theta1 = 93.461, 差分 = 0.0550
425回目: theta0 = 429.070, theta1 = 93.462, 差分 = 0.0529
426回目: theta0 = 429.072, theta1 = 93.462, 差分 = 0.0508
427回目: theta0 = 429.073, theta1 = 93.462, 差分 = 0.0488
428回目: theta0 = 429.075, theta1 = 93.463, 差分 = 0.0468
429回目: theta0 = 429.076, theta1 = 93.463, 差分 = 0.0450
430回目: theta0 = 429.078, theta1 = 93.463, 差分 = 0.0432
431回目: theta0 = 429.079, theta1 = 93.463, 差分 = 0.0415
432回目: theta0 = 429.080, theta1 = 93.464, 差分 = 0.0398
433回目: theta0 = 429.082, theta1 = 93.464, 差分 = 0.0383
434回目: theta0 = 429.083, theta1 = 93.464, 差分 = 0.0367
435回目: theta0 = 429.085, theta1 = 93.465, 差分 = 0.0353
436回目: theta0 = 429.086, theta1 = 93.465, 差分 = 0.0339
437回目: theta0 = 429.087, theta1 = 93.465, 差分 = 0.0325
438回目: theta0 = 429.088, theta1 = 93.465, 差分 = 0.0313
439回目: theta0 = 429.090, theta1 = 93.466, 差分 = 0.0300
440回目: theta0 = 429.091, theta1 = 93.466, 差分 = 0.0288
441回目: theta0 = 429.092, theta1 = 93.466, 差分 = 0.0277
442回目: theta0 = 429.093, theta1 = 93.467, 差分 = 0.0266
443回目: theta0 = 429.094, theta1 = 93.467, 差分 = 0.0255
444回目: theta0 = 429.095, theta1 = 93.467, 差分 = 0.0245
445回目: theta0 = 429.097, theta1 = 93.467, 差分 = 0.0236
446回目: theta0 = 429.098, theta1 = 93.467, 差分 = 0.0226
447回目: theta0 = 429.099, theta1 = 93.468, 差分 = 0.0217
448回目: theta0 = 429.100, theta1 = 93.468, 差分 = 0.0209
449回目: theta0 = 429.101, theta1 = 93.468, 差分 = 0.0200
450回目: theta0 = 429.102, theta1 = 93.468, 差分 = 0.0192
451回目: theta0 = 429.103, theta1 = 93.469, 差分 = 0.0185
452回目: theta0 = 429.104, theta1 = 93.469, 差分 = 0.0178
453回目: theta0 = 429.105, theta1 = 93.469, 差分 = 0.0171
454回目: theta0 = 429.105, theta1 = 93.469, 差分 = 0.0164
455回目: theta0 = 429.106, theta1 = 93.469, 差分 = 0.0157
456回目: theta0 = 429.107, theta1 = 93.470, 差分 = 0.0151
457回目: theta0 = 429.108, theta1 = 93.470, 差分 = 0.0145
458回目: theta0 = 429.109, theta1 = 93.470, 差分 = 0.0139
459回目: theta0 = 429.110, theta1 = 93.470, 差分 = 0.0134
460回目: theta0 = 429.111, theta1 = 93.470, 差分 = 0.0129
461回目: theta0 = 429.111, theta1 = 93.470, 差分 = 0.0123
462回目: theta0 = 429.112, theta1 = 93.471, 差分 = 0.0119
463回目: theta0 = 429.113, theta1 = 93.471, 差分 = 0.0114
464回目: theta0 = 429.114, theta1 = 93.471, 差分 = 0.0109
465回目: theta0 = 429.114, theta1 = 93.471, 差分 = 0.0105
466回目: theta0 = 429.115, theta1 = 93.471, 差分 = 0.0101
467回目: theta0 = 429.116, theta1 = 93.471, 差分 = 0.0097
#+end_example

#+begin_src jupyter-python :session py
x = np.linspace(-3, 3, 100)

plt.plot(train_z, train_y, 'o')
plt.plot(x, f(x))
plt.show()
#+end_src

#+RESULTS:
[[file:./.ob-jupyter/66c6ee5020a0b9b7381920e6a684ceb09cff640a.png]]

#+begin_src jupyter-python :session py
f(standardize(100))
#+end_src

#+RESULTS:
: 371.06709721786865

#+begin_src jupyter-python :session py
f(standardize(200))
#+end_src

#+RESULTS:
: 510.60708082666844

#+begin_src jupyter-python :session py
f(standardize(300))
#+end_src

#+RESULTS:
: 650.1470644354682
